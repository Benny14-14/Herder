<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Panel â€“ Herdernacht</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen p-6">
  <div class="max-w-6xl mx-auto">
    <header class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-bold">ðŸ›  Admin Panel</h1>
      <button id="logoutBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Abmelden</button>
    </header>

    <section id="content">
      <p>Lade Daten...</p>
    </section>
  </div>

  <script>
    // ===== Login-Status prÃ¼fen =====
    const loggedInUserId = localStorage.getItem("loggedInUserId");
    const loggedInUsername = localStorage.getItem("loggedInUsername");

    if (!loggedInUserId) {
      // Nicht eingeloggt â†’ zurÃ¼ck zur Login-Seite
      window.location.href = "login.html";
    }

    // ===== Firebase konfigurieren =====
    const firebaseConfig = {
      apiKey: "AIzaSyApqXsW-bTblW66DVMTw4S-dsND92-wBFQ",
      authDomain: "herder-7dd17.firebaseapp.com",
      projectId: "herder-7dd17",
      storageBucket: "herder-7dd17.firebasestorage.app",
      messagingSenderId: "472463332211",
      appId: "1:472463332211:web:6b8ea4a8d1480792a62b06",
      measurementId: "G-HR07N6LXGN"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const logoutBtn = document.getElementById("logoutBtn");
    const content = document.getElementById("content");

    // ===== Logout: localStorage lÃ¶schen und zurÃ¼ck zur Login-Seite =====
    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("loggedInUserId");
      localStorage.removeItem("loggedInUsername");
      window.location.href = "login.html";
    });

    // ===== BegrÃ¼ÃŸung anzeigen =====
    content.innerHTML = `<p>Willkommen, ${loggedInUsername}!</p><p>Hier kannst du jetzt deine Admin-Daten laden und bearbeiten.</p>`;

    // ===== WÃ¼nsche laden und anzeigen =====
    db.collection("wuensche").get()
      .then(snapshot => {
        if (snapshot.empty) {
          content.innerHTML += "<p>Keine WÃ¼nsche gefunden.</p>";
          return;
        }

        let html = `<h2 class="text-xl font-bold mt-6 mb-2">SongwÃ¼nsche</h2><ul class="list-disc ml-6">`;
        snapshot.forEach(doc => {
          const data = doc.data();
          html += `<li><strong>${data.song || "Unbekannter Song"}</strong> von ${data.user || "Unbekannter User"}</li>`;
        });
        html += "</ul>";
        content.innerHTML += html;
      })
      .catch(error => {
        content.innerHTML += `<p class="text-red-500">Fehler beim Laden der WÃ¼nsche: ${error.message}</p>`;
      });
  </script>
</body>
</html>
